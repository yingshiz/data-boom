<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" href="https://bj.sofang.com/favicon.ico" mce_href="/favicon.ico" type="image/x-icon">
  <title>房租</title>	
  <style>
	body{background-color: rgb(23, 24, 24);}
	textarea{
	margin: 0 auto;
    width: 90%;
    display: block;
	height:250px;
	}
	.btn{
	display: block;
    margin: 10px auto;
    width: 80px;
    height: 30px;
	}
  </style>
 <script src="https://www.itxst.com/package/clipboardjs/clipboard.min.js"></script>
 </head>
 <body>
  <textarea name="" id="a" cols="30" rows="10"  onchange="deal(this)" onchange="deal(this)"></textarea>
  <textarea name="" id="b" cols="30" rows="10">
  </textarea>
<input class="btn" id="btn" type="button" value="复制" data-clipboard-target="#b">
 </body>
 <script src="https://n.sinaimg.cn/ent/js/lib/jquery-1.7.2.js"></script>
  <script>
	function deal(){
		const  a = $('#a').val();
		let r = a.split('栋');
		r = r[1].replaceAll(',','.').replace(/[^\d.]/g, ' ');
		r = r.split(' ');
		r = r.filter(str => str !== '');
		console.log(r);
		str = r[0]+'房 '+r[1]+'年'+r[2]+'月'+r[3]+'日'+'\r\n';
		str +='冷水:'+'\r\n';
		str +='  用量:'+r[6]+'-'+r[4]+'='+r[8]+'(吨)'+'\r\n';
		str +='  费用:'+r[10]+' x '+r[8]+' = '+r[12]+'元'+'\r\n';
		str +='热水:'+'\r\n';
		str +='  用量:'+r[7]+'-'+r[5]+'='+r[9]+'(吨)'+'\r\n';
		str +='  费用:'+r[11]+' x '+r[9]+' = '+r[13]+'元'+'\r\n';
		str +='电:'+'\r\n';
		str +='  用量:'+r[16]+'-'+r[15]+'='+r[14]+'(度)'+'\r\n';
		str +='  费用:'+r[18]+' x '+r[17]+' = '+r[14]+'元'+'\r\n';
		let wf = '';
		if(r[20]=='30') 	{
			str +='网费:30元'+'\r\n';
			wf = '+30';
		}
		str +='房租:'+r[19]+'元'+'\r\n';
		let total = parseFloat(r[12])+parseFloat(r[13])+parseFloat(r[14])+parseFloat(r[19]);
		if (wf!='')
		{
			total+=parseFloat(wf);
		}
		str +='合计：' +r[12]+'+'+r[13]+'+'+r[14]+wf+'+'+r[19]+'='+total+'(元)';	
		$('#b').val(str);
	}
        var clipboard = new ClipboardJS('.btn');

        clipboard.on('success', function (e) {
            e.clearSelection();
			$('#btn').val("复制成功");
        });

        clipboard.on('error', function (e) {
			$('#btn').val("复制失败");
        });
  </script>
</html>
