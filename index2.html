<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="icon" href="https://bj.sofang.com/favicon.ico" mce_href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="http://img.itmop.com/upload/2016-1/2016122105237.png" />
	<link rel="apple-touch-icon" sizes="72x72" href="http://img.itmop.com/upload/2016-1/2016122105237.png" />
	<link rel="apple-touch-icon" sizes="114x114" href="http://img.itmop.com/upload/2016-1/2016122105237.png" />
  <title>房租</title>	
  <style>
	body{background-color: rgb(23, 24, 24);}
	textarea{
	margin: 0 auto;
    width: 90%;
    display: block;
	height:250px;
	}
	.btn{
	display: block;
    margin: 10px auto;
    width: 80px;
    height: 30px;
	}
  </style>
 <script src="https://www.itxst.com/package/clipboardjs/clipboard.min.js"></script>
 </head>
 <body>
  <textarea name="" id="a" cols="30" rows="10"  onchange="deal(this)" onkeyup="deal(this)"></textarea>
  <textarea name="" id="b" cols="30" rows="10">
  </textarea>
<input class="btn" id="btn" type="button" value="复制" data-clipboard-target="#b">
 </body>
 <script src="jquery.min.js"></script>
  <script>
	function deal(){
		var a = $('#a').val();
		var fstr = '';
		var tmp = a.split('栋');
		var tmp1 = tmp[1].split('日');
		var top = tmp1[0].replace(' ','').replace('.','').replace(/\s+/g,'').replace('年','-').replace('月','-').replace('房','房 ');		
		fstr += top+"\r\n"; //抬头
		var tmp = tmp1[1].split('吨）');
		tmp = tmp[1].replace(',','.').replace('>','');
		var water = $.trim(tmp.split('电费')[0]).replaceAll('冷','').replaceAll('热','_').replace(',','.');
		waters = water.split(' ');
		var lenshui1 = waters[0].split('_')[0];
		var lenshui2 = waters[1].split('_')[0];
		var lenshui_n = waters[2].split('_')[0]; 
		var reshui1 = waters[0].split('_')[1];
		var reshui2 = waters[1].split('_')[1];
		var reshui_n = waters[2].split('_')[1];
		var lenshui = '冷水\r\n  用量:'+lenshui2+'-' + lenshui1+'='+lenshui_n+'(吨)';

		var lsdj = 5;//冷水单价
		var fy1 = parseFloat(lenshui_n) * lsdj;
		lenshui +='\r\n  费用:'+lenshui_n +' x '+lsdj+' = '+fy1+'(元)';
		var reshui = '热水\r\n  用量:'+reshui2+'-' + reshui1+'='+reshui_n+'(吨)';
		var rsdj = 30;//热水单价
		var fy2 = parseFloat(reshui_n) *rsdj;
		reshui +='\r\n  费用:'+reshui_n +' x '+rsdj+' = '+fy2+'(元)';
		
		fstr += lenshui+"\r\n"+reshui;//水费

		var tmp = $.trim(tmp.split('电费')[1]);
		var dian =$.trim(tmp.split('房租')[0].replace('（度）',''));
		dian = dian.split(' ');
		fstr += "\r\n电\r\n  用量："+dian[1]+'-'+dian[0]+'='+dian[2]+'(度)';//电费
		var ddj = 1;//电单价
		var fy3 = parseFloat(dian[2]) *ddj;		
		fstr +='\r\n  费用:'+dian[2] +' x '+ddj+' = '+fy3+'(元)';	
		
		var fy4= parseFloat($.trim(tmp.split('房租')[1].split('卫')[0]));
		fstr += '\r\n房租:'+fy4+'(元)';
		var total = fy1+fy2+fy3+fy4;
		fstr +='\r\n合计：' +fy1+'+'+fy2+'+'+fy3+'+'+fy4+'='+total+'(元)';	

		$('#b').val(fstr);
	}
        var clipboard = new ClipboardJS('.btn');

        clipboard.on('success', function (e) {
            e.clearSelection();
			$('#btn').val("复制成功");
        });

        clipboard.on('error', function (e) {
			$('#btn').val("复制失败");
        });
  </script>
</html>
